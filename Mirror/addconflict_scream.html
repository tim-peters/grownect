<!DOCTYPE HTML>
<html>
	<head>
		<meta http-equiv="Content-Style-Type" content="text/css">
		<meta http-equiv="Content-Script-Type" content="text/javascript">
		<title>Mirror</title>

	<script type="text/javascript" src="./js/core/jquery.js"></script>
	<script type="text/javascript" src="./js/core/jquery.knob.js"></script>

     <link href='http://fonts.googleapis.com/css?family=PT+Sans' rel='stylesheet' type='text/css'>

	<link rel="stylesheet" type="text/css" href="style/all.css">


	</head>
<body>

	<div class="usercontainer small">
	
	
		<div class="user" style="background-image:url(img/grownect_nadine.png)">
		<div class="openconflicts" style="background-color:#f2786d"><br>1</div>
		<div class="menu">
			<ul> 
				<li><br><br><img src="img/moment-w.png" width="25"><br><br>create<br>moment</li>
				<li><img src="img/conflict-w.png" width="25"><br><br>add<br>conflict</li>	
			</ul>
		</div>
	</div>

		<div class="user" style="background-image:url(img/grownect_nadine.png)">
		<div class="openconflicts" style="background-color:#acda8d"><br>2</div>
		<div class="menu">
			<ul> 
				<li><br><br><img src="img/moment-w.png" width="25"><br><br>create<br>moment</li>
				<li><img src="img/conflict-w.png" width="25"><br><br>add<br>conflict</li>		
			</ul>
		</div>
	</div>
	
		<div class="user clickeduser" style="background-image:url(img/Bali_2013.jpg)">
		<div class="openconflicts"  style="background-color:#8d1c1c"><br></div>
		<div class="menu">
			<ul> 
				<li><br><br><img src="img/moment-w.png" width="25"><br><br>create<br>moment</li>
				<li><img src="img/conflict-w.png" width="25"><br><br>add<br>conflict</li>		
			</ul>
		</div>
	</div>

	<div class="user clickeduser" style="background-image:url(img/grownect_nadine.png)">
		<div class="openconflicts" style="background-color:#f59556"><br>5</div>
		<div class="menu">
			<ul> 
				<li><br><br><img src="img/profile.png" width="20"><br><br>show<br>profile</li>
				<li><img src="img/statistic.png" width="20"><br><br>show<br>conflicts</li>	
			</ul>
		</div>
	</div>

	<div class="user" style="background-image:url(img/grownect_tim.png)">	
		<div class="openconflicts" style="background-color:#1b3140"><br>3</div>
		<div class="menu">
			<ul> 
				<li><br><br><img src="img/moment-w.png" width="25"><br><br>create<br>moment</li>
				<li><img src="img/conflict-w.png" width="25"><br><br>add<br>conflict</li>			
			</ul>
		</div>
	</div>
 

</div>


<h2> Let out your rage by screaming into your<br> bracelet as loud as you can. </h2>

<div class="scream"> 
<input type="text" value="0.5" class="dial">
</div>



 <button type="button" type="submit" class="next"><img src="img/next.png" width="15">Next</button>


</body>

<script type="text/javascript">
var audioContext = null;
var audioSource = null;
var audioAnalyser = null;
var audioGain = null;
var audioData = null;
var volume = null;

var audioStart = function (){
    navigator.getUserMedia = ( navigator.getUserMedia ||
                       navigator.webkitGetUserMedia ||
                       navigator.mozGetUserMedia ||
                       navigator.msGetUserMedia);
    
    navigator.getUserMedia({
        audio : true,
        video : false
    }, audioSuccess, audioError);
};

var audioSuccess = function(stream) {
    window.AudioContext = ( window.AudioContext ||
    				    window.webkitAudioContext ||
    				    window.mozAudioContext ||
    				    window.msAudioContext);
    
    var fftSize = 256;
    
    audioContext = new AudioContext();
    audioSource = audioContext.createMediaStreamSource(stream);
    
    audioGain = audioContext.createGain();
    audioGain.gain.value = 0; //Lautst√§rke
    audioGain.connect(audioContext.destination);
    
    audioAnalyser = audioContext.createAnalyser();
    audioAnalyser.fftSize = fftSize;
    audioAnalyser.connect(audioGain);
    
    audioData = new Uint8Array(fftSize * 0.5);
    audioSource.connect(audioGain);
    audioSource.connect(audioAnalyser);
    
    var sampleAudioStream = function() {
        audioAnalyser.getByteFrequencyData(audioData);
        
        for (var i = 0, length = audioData.length, sum = 0; i < length; i++) {
            sum += audioData[i];
        }
        
        volume = sum / (length * 256);
        //document.getElementById("loudnessIndikator").style.width = volume+"px";
        //document.getElementById("h1").innerHTML = volume;
        $(".dial").val(volume).trigger("change");
    };
    
    setInterval(sampleAudioStream, 20);
    
    volume = 0;
};

var audioError = function(event) {
  console.error("audioError");  
};

$(function() {
    $(".dial").knob({
        'min':0,
        'max':.3,
        'step':0.01,
        'angleArc':180,
        'angleOffset':-90,
        'readOnly':true,
        'displayPrevious':true,
        'thickness':0.1,
        'fgColor':"#fff",
    	'bgColor':'#333',
    	'inputColor':"#ffffff"

    });
});

audioStart();
</script>

</html>